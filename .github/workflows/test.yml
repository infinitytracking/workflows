name: Terraform version check

on: push

jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Update Terraform
        id: update
        run: |
          bash scripts/terraform_version_checker.sh

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v3
        with:
          author: InfinityGitHubActions <githubactions@infinity.co>
          commit-message: Bump Terraform
          committer: InfinityGitHubActions <githubactions@infinity.co>
          reviewers: |
            JCradock
          title: Bump Terraform from ${{ steps.update.outputs.EXISTING_VERSION }} to ${{ steps.update.outputs.LATEST_VERSION }}
          token: ${{ secrets.CI_TOKEN }}
          body: >
            This PR is auto-generated.
            ${{ steps.update.outputs.RELEASE }}
